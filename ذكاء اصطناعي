import os
import tkinter as tk
from tkinter import scrolledtext, messagebox
from google import genai
from google.genai import types

# --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ) ---
MODEL = 'gemini-2.5-flash'
SYSTEM_INSTRUCTION = "Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ¯ÙˆØ¯ ÙˆÙ…ÙÙŠØ¯ØŒ ØªØ¬ÙŠØ¨ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰. ÙƒÙ† Ù…Ø®ØªØµØ±Ø§Ù‹ ÙˆÙˆØ§Ø¶Ø­Ø§Ù‹."
client = None
chat = None

def setup_ai():
    """ØªÙ‡ÙŠØ¦Ø© Ø§ØªØµØ§Ù„ Gemini ÙˆØ¨Ø¯Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©."""
    global client, chat
    try:
        # Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
        client = genai.Client()
        
        # Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
        chat = client.chats.create(
            model=MODEL,
            config=types.GenerateContentConfig(
                system_instruction=SYSTEM_INSTRUCTION
            )
        )
        return True
    except Exception as e:
        messagebox.showerror("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©", 
                             f"ÙØ´Ù„ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹ÙŠÙŠÙ† Ù…ØªØºÙŠØ± Ø§Ù„Ø¨ÙŠØ¦Ø© GEMINI_API_KEY. Ø§Ù„ØªÙØ§ØµÙŠÙ„: {e}")
        return False

# --- ÙˆØ¸Ø§Ø¦Ù ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (GUI Functions) ---

def send_message():
    """Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¹Ø±Ø¶ Ø±Ø¯ Ø§Ù„Ø±ÙˆØ¨ÙˆØª."""
    user_input = user_entry.get()
    if not user_input.strip():
        return

    # Ù…Ø³Ø­ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    user_entry.delete(0, tk.END)

    # Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    chat_history.config(state=tk.NORMAL)
    chat_history.insert(tk.END, f"Ø£Ù†Øª: {user_input}\n", 'user')
    chat_history.config(state=tk.DISABLED)
    chat_history.see(tk.END)

    # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø¯ Ù…Ù† Gemini
    try:
        response = chat.send_message(user_input)
        
        # Ø¹Ø±Ø¶ Ø±Ø¯ Ø§Ù„Ø±ÙˆØ¨ÙˆØª
        chat_history.config(state=tk.NORMAL)
        chat_history.insert(tk.END, f"Ø§Ù„Ø±ÙˆØ¨ÙˆØª: {response.text}\n\n", 'bot')
        chat_history.config(state=tk.DISABLED)
        chat_history.see(tk.END)
        
    except Exception as e:
        chat_history.config(state=tk.NORMAL)
        chat_history.insert(tk.END, f"âŒ Ø®Ø·Ø£: Ø­Ø¯Ø«Øª Ù…Ø´ÙƒÙ„Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„.\n\n", 'error')
        chat_history.config(state=tk.DISABLED)
        messagebox.showerror("Ø®Ø·Ø£", f"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©: {e}")

# --- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø³ÙˆÙ…ÙŠØ© (GUI Setup) ---

# ØªÙ‡ÙŠØ¦Ø© Ù†Ø§ÙØ°Ø© Tkinter
root = tk.Tk()
root.title("ğŸ¤– Ø±ÙˆØ¨ÙˆØª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠ")
root.geometry("600x500")
root.option_add('*Font', 'Arial 12') # ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø®Ø· Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ

# ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù„ØªØ¯Ø¹Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ù„Ù„ÙŠØ³Ø§Ø±)
root.tk_setPalette(background='#f0f0f0')

# Ù…Ø±Ø¨Ø¹ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© (ScrolledText)
chat_history = scrolledtext.ScrolledText(root, wrap=tk.WORD, state=tk.DISABLED, 
                                         bg='white', bd=1, relief=tk.FLAT)
chat_history.pack(pady=10, padx=10, fill=tk.BOTH, expand=True)

# Ø¥Ø¶Ø§ÙØ© ÙˆØ³ÙˆÙ… Ù„Ù„Ø£Ù„ÙˆØ§Ù† (Tags for colors)
chat_history.tag_config('user', foreground='blue')
chat_history.tag_config('bot', foreground='black', font=('Arial', 12, 'bold'))
chat_history.tag_config('error', foreground='red')

# Ø¥Ø·Ø§Ø± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ§Ù„Ø²Ø±
input_frame = tk.Frame(root, padx=10, pady=5)
input_frame.pack(fill=tk.X)

# Ù…Ø±Ø¨Ø¹ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
user_entry = tk.Entry(input_frame, bd=1, relief=tk.SOLID, justify='right') # Ù…Ø­Ø§Ø°Ø§Ø© Ù„Ù„ÙŠÙ…ÙŠÙ†
user_entry.pack(side=tk.LEFT, fill=tk.X, expand=True, ipady=5)
user_entry.bind("<Return>", lambda event: send_message()) # Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter

# Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
send_button = tk.Button(input_frame, text="Ø¥Ø±Ø³Ø§Ù„", command=send_message, bg='#4CAF50', fg='white', 
                        relief=tk.FLAT)
send_button.pack(side=tk.LEFT, padx=(5, 0), ipady=5)

# --- Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ---

# 1. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
if setup_ai():
    # Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ Ø£ÙˆÙ„Ù‰
    chat_history.config(state=tk.NORMAL)
    chat_history.insert(tk.END, "ğŸ¤– Ø§Ù„Ø±ÙˆØ¨ÙˆØª: Ù…Ø±Ø­Ø¨Ø§Ù‹! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ\n\n", 'bot')
    chat_history.config(state=tk.DISABLED)
    
    # 2. ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ÙˆØ§Ø¬Ù‡Ø©
    root.mainloop()
pip install pyinstaller
 pyinstaller --onefile --windowed tkinter_chatbot.py
