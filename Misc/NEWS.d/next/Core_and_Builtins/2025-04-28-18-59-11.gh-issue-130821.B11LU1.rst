Enhance wrong type error messages and make them more consistent. Patch by
Semyon Moroz.
