Fix :func:`winreg.QueryValueEx` to not accidentally read garbage buffer under race condition.
